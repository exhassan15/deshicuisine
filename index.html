<script>
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ EASY EDIT DATA SECTION - CHANGE YOUR INFO HERE!
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // To edit: Go to GitHub â†’ Click index.html â†’ Click âœï¸ Edit â†’ Change values below â†’ Commit
  // Changes will be live in 1 minute on ALL devices!
  
  const ADMIN_PASSWORD = 'admin123'; // Change this to your secure password
  const GITHUB_TOKEN = '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'; // â† ADD YOUR TOKEN HERE
  const GITHUB_REPO = 'exhassan15/deshicuisine'; // â† ADD YOUR REPO NAME HERE (e.g., yourusername/deshi-cuisine)
  
  const MENU_DATA = {
    wednesday: {
      name: 'Chicken Biryani',
      desc: 'Fragrant basmati rice with tender chicken, aromatic spices, saffron, and fried onions.',
      price: 1299,
      emoji: 'ğŸ›'
    },
    saturday: {
      name: 'Vuna Khicuri with Duck',
      desc: 'Traditional slow-cooked khichuri with caramelized onions and slow-cooked duck.',
      price: 1999,
      emoji: 'ğŸ²'
    }
  };

  const BUSINESS_SETTINGS = {
    businessName: 'Deshi Cuisine',
    phone: '+8108052136996',
    email: 'exhassan15@gmail.com',
    orderDays: 'Wednesday & Saturday'
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // END OF EASY EDIT SECTION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  let isLoggedIn = false;
  let orders = [];

  // Save order to GitHub
  async function saveOrderToGitHub(order) {
    try {
      // First, get existing orders
      const existingOrders = await getOrdersFromGitHub();
      existingOrders.unshift({
        ...order,
        id: Date.now() + Math.random().toString(36).substr(2, 9)
      });

      // Save back to GitHub
      const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/orders.json`, {
        method: 'PUT',
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          message: `New order from ${order.customerName}`,
          content: btoa(JSON.stringify(existingOrders, null, 2)),
          sha: await getFileSHA()
        })
      });

      return response.ok;
    } catch (error) {
      console.error('Error saving to GitHub:', error);
      
      // Fallback: Save to localStorage
      const localOrders = JSON.parse(localStorage.getItem('deshi_orders') || '[]');
      localOrders.unshift(order);
      localStorage.setItem('deshi_orders', JSON.stringify(localOrders));
      
      return false;
    }
  }

  // Get orders from GitHub
  async function getOrdersFromGitHub() {
    try {
      const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/orders.json`, {
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`
        }
      });

      if (response.ok) {
        const data = await response.json();
        const content = atob(data.content);
        return JSON.parse(content);
      }
      return [];
    } catch (error) {
      console.error('Error fetching from GitHub:', error);
      
      // Fallback: Get from localStorage
      return JSON.parse(localStorage.getItem('deshi_orders') || '[]');
    }
  }

  // Get file SHA for updating
  async function getFileSHA() {
    try {
      const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/orders.json`, {
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`
        }
      });
      
      if (response.ok) {
        const data = await response.json();
        return data.sha;
      }
      return null;
    } catch (error) {
      return null;
    }
  }

  // Display orders in admin panel
  async function displayOrders() {
    const ordersList = document.getElementById('ordersList');
    const orderCount = document.getElementById('orderCount');
    
    try {
      orders = await getOrdersFromGitHub();
      orderCount.textContent = orders.length;
      
      if (orders.length === 0) {
        ordersList.innerHTML = '<p class="text-gray-500 text-center py-8">No orders yet</p>';
        return;
      }

      ordersList.innerHTML = orders.map((order, index) => `
        <div class="order-card">
          <div class="flex justify-between items-start mb-3">
            <h4 class="font-bold text-lg text-gray-800">${order.customerName}</h4>
            <span class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">NEW</span>
          </div>
          <div class="space-y-1 text-sm">
            <p class="text-gray-700"><strong>ğŸ“ Phone:</strong> ${order.customerPhone}</p>
            <p class="text-gray-700"><strong>ğŸ“§ Email:</strong> ${order.customerEmail}</p>
            <p class="text-gray-700"><strong>ğŸ“… Day:</strong> ${order.deliveryDay}</p>
            <p class="text-gray-700"><strong>ğŸ“ Address:</strong> ${order.deliveryAddress}</p>
            <p class="text-gray-700"><strong>ğŸ½ï¸ Order:</strong> ${order.orderDetails}</p>
            ${order.specialInstructions ? `<p class="text-gray-700"><strong>ğŸ’¬ Notes:</strong> ${order.specialInstructions}</p>` : ''}
            <p class="text-gray-400 text-xs mt-2">ğŸ•’ ${order.timestamp}</p>
          </div>
          <button onclick="deleteOrder('${order.id}')" class="mt-3 w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition font-semibold text-sm">
            ğŸ—‘ï¸ Delete This Order
          </button>
        </div>
      `).join('');
    } catch (error) {
      ordersList.innerHTML = '<p class="text-red-500 text-center py-8">Error loading orders</p>';
    }
  }

  // Delete order
  async function deleteOrder(orderId) {
    if (!confirm('Delete this order?')) return;
    
    try {
      orders = orders.filter(order => order.id !== orderId);
      
      const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/orders.json`, {
        method: 'PUT',
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          message: `Deleted order ${orderId}`,
          content: btoa(JSON.stringify(orders, null, 2)),
          sha: await getFileSHA()
        })
      });

      if (response.ok) {
        displayOrders();
        alert('âœ… Order deleted!');
      }
    } catch (error) {
      console.error('Error deleting order:', error);
      alert('âŒ Error deleting order');
    }
  }

  // Clear all orders
  document.getElementById('clearAllOrders').addEventListener('click', async () => {
    if (!confirm('Delete ALL orders? This cannot be undone!')) return;
    
    try {
      const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/orders.json`, {
        method: 'PUT',
        headers: {
          'Authorization': `token ${GITHUB_TOKEN}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          message: 'Cleared all orders',
          content: btoa(JSON.stringify([], null, 2)),
          sha: await getFileSHA()
        })
      });

      if (response.ok) {
        orders = [];
        displayOrders();
        alert('âœ… All orders cleared!');
      }
    } catch (error) {
      console.error('Error clearing orders:', error);
      alert('âŒ Error clearing orders');
    }
  });

  window.deleteOrder = deleteOrder;

  // Update display with menu and settings
  function updateDisplay() {
    // Menu
    document.getElementById('wed-name-display').textContent = MENU_DATA.wednesday.name;
    document.getElementById('wed-desc-display').textContent = MENU_DATA.wednesday.desc;
    document.getElementById('wed-price-display').textContent = 'Â¥' + MENU_DATA.wednesday.price.toLocaleString();
    document.getElementById('wed-emoji-display').textContent = MENU_DATA.wednesday.emoji;
    
    document.getElementById('sat-name-display').textContent = MENU_DATA.saturday.name;
    document.getElementById('sat-desc-display').textContent = MENU_DATA.saturday.desc;
    document.getElementById('sat-price-display').textContent = 'Â¥' + MENU_DATA.saturday.price.toLocaleString();
    document.getElementById('sat-emoji-display').textContent = MENU_DATA.saturday.emoji;
    
    // Settings
    document.getElementById('displayBusinessName').textContent = BUSINESS_SETTINGS.businessName.toUpperCase();
    document.getElementById('footerBusinessName').textContent = BUSINESS_SETTINGS.businessName;
    document.getElementById('displayOrderDays').textContent = BUSINESS_SETTINGS.orderDays;
    document.getElementById('displayEmail').textContent = BUSINESS_SETTINGS.email;
    document.getElementById('displayEmail').href = 'mailto:' + BUSINESS_SETTINGS.email;
    document.getElementById('displayPhone').textContent = BUSINESS_SETTINGS.phone;
  }

  // Login system
  document.getElementById('adminBtn').addEventListener('click', () => {
    if (isLoggedIn) {
      document.getElementById('adminModal').classList.add('active');
      displayOrders();
    } else {
      document.getElementById('loginModal').classList.add('active');
      document.getElementById('adminPassword').focus();
    }
  });

  document.getElementById('loginBtn').addEventListener('click', () => {
    const password = document.getElementById('adminPassword').value;
    if (password === ADMIN_PASSWORD) {
      isLoggedIn = true;
      document.getElementById('loginModal').classList.remove('active');
      document.getElementById('adminModal').classList.add('active');
      document.getElementById('adminPassword').value = '';
      displayOrders();
    } else {
      alert('âŒ Incorrect password!');
      document.getElementById('adminPassword').value = '';
      document.getElementById('adminPassword').focus();
    }
  });

  document.getElementById('cancelLogin').addEventListener('click', () => {
    document.getElementById('loginModal').classList.remove('active');
    document.getElementById('adminPassword').value = '';
  });

  document.getElementById('adminPassword').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      document.getElementById('loginBtn').click();
    }
  });

  document.getElementById('closeModal').addEventListener('click', () => {
    document.getElementById('adminModal').classList.remove('active');
  });

  document.getElementById('refreshOrders').addEventListener('click', () => {
    displayOrders();
  });

  // Order form submission
  document.getElementById('orderForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const order = {
      id: Date.now() + Math.random().toString(36).substr(2, 9),
      customerName: formData.get('customerName'),
      customerEmail: formData.get('customerEmail'),
      customerPhone: formData.get('customerPhone'),
      deliveryDay: formData.get('deliveryDay'),
      deliveryAddress: formData.get('deliveryAddress'),
      orderDetails: formData.get('orderDetails'),
      specialInstructions: formData.get('specialInstructions'),
      timestamp: new Date().toLocaleString()
    };

    const saveBtn = e.target.querySelector('button[type="submit"]');
    const originalText = saveBtn.innerHTML;
    saveBtn.innerHTML = 'â³ Saving...';
    saveBtn.disabled = true;

    const success = await saveOrderToGitHub(order);
    
    if (success) {
      e.target.reset();
      alert('âœ… Order submitted successfully!\n\nWe will contact you soon to confirm your order.');
    } else {
      alert('âš ï¸ Order saved locally. Please check your internet connection.');
    }

    saveBtn.innerHTML = originalText;
    saveBtn.disabled = false;
  });

  // Initialize
  updateDisplay();
</script>
